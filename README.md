# MATLAB課題マニュアル

## このマニュアルについて
- 日本語のマニュアルです
	- 留学生の皆さんでわからないことは直接聞いてください

## 目次
1. [はじめに](#anchor1)
	1. [このリポジトリについて](#anchor1-1)
	1. [以下に登場する言葉について](#anchor1-2)
1. [提出方法](#anchor2)
	1. [提出する際の注意・お願い](#anchor2-1)
1. [採点・評価](#anchor3)
	1. [0点の例](#anchor3-1)
1. [フィードバック等に関して](#anchor4)
1. [その他注意事項](#anchor5)
1. [便利なWebサービス](#anchor6)
1. [参考: コーディングのあれこれ](#anchor7)


<a id="anchor1"></a>
### はじめに
<a id="anchor1-1"></a>
#### このリポジトリについて
- 作成者: 三田 光星 (京都大学大学院経済学研究科 D2)
- 京都大学経済学部・大学院経済学研究科等で開講される江上先生のMATLAB講義に関しての注意事項を掲載しています
	- sampleは課題とは無関係ですがMATLABで動く実際のコードを置いています
	- こういう感じでファイルを作ってください

<a id="anchor1-2"></a>
#### 以下に登場する言葉について
- コンソール
	- プログラムを実行するための画面
	- Windows OSにおけるコマンドプロンプト、Mac OSにおけるTerminalの画面みたいなもの
- 関数mファイル
	- 拡張子は.m
	- 引数を処理して返り値を出すための機械
	- 採点の9割9分はこのファイルを見て行います
- スクリプトファイル
	- 拡張子は.m
	- 実際に実行する処理を書いた手順書
		- 例: 関数にこの値を代入して、そうして得られた値をグラフにします
	- 「このファイルを実行すれば課題の値が計算できる」という状態で提出します

<a id="anchor2"></a>
### 提出方法
- 課題用アドレスに関数mファイルとスクリプトファイルを送ってください
	- 使った関数は全て送ってください。
		- 過去送ったものでもこちらが見つけられない場合があるので、いちいち添付してもらえると助かります。
	- 関数mファイルのいらなさそうな簡単な処理でも、指示に従って必ず作ってください
	- コンソールでCtrl+Sをして得られる.matファイルはスクリプトファイルではありません
		- 詳しくは調べてほしいですが、定義した変数の格納しか行わないので採点できません
	- もちろん.txtファイルはここで言うスクリプトファイルではありません
		- たとえ1行だとしてもコピペする手間が発生します
	- ライブスクリプトファイル (拡張子.mlx)はオーバーキルです
		- .mlxでも問題はありませんが、開くのが地味に重いファイルなので.mで十分です

<a id="anchor2-1"></a>
#### 送信する際の注意・お願い
- 採点者はMac OSを使っています
	- Mac OS Catalinaにおいてアーカイブユーティリティのバグが報告されています
	- 2020年5月現在、文字コードShift-JISのzipファイルは展開できません (参考: [Macで「エラー22 引数が無効です」となる原因](https://itips.krsw.biz/mac-error22-invalid-parameter/))
	- そのためファイルはなるべく圧縮せずに送ってください


<a id="anchor3"></a>
### 採点・評価
- 採点基準は以下の通りです
	- 適切な処理を行った上でコンパイルし、値も十分正しいと言える (100%)
		- MATLABは計算速度が遅くなる場合も警告を出しますが、それは採点には影響しません
		- 直しておく癖をつけておくと、今後膨大なファイルを扱うときに困らないので、直すことをおすすめします
	- コンパイルするが、値に影響する軽微なミスがある (50%)
		- 軽微なミスは採点者の主観に依存します
		- 次の項で0点の例を提示するので、それに当てはまらないと思った場合は異議申し立てを受け付けます
	- 致命的なミスがある、ファイルが不足している、コンパイルしない etc. (0%)

<a id="anchor3-1"></a>
#### 0点の例
- 株価50、行使価格50のオプションの価格なのにオーダーが10の200乗
	- ありえない値が出た場合は必ずデバッグしてください
	- コンパイルしててもこの場合は問答無用で0点です
- Monte-Carlo Simulationのためのサンプル発生ファイルがない
	- 複数の関数mファイルを使う場合、1つでも欠けると動きません
- スクリプトファイルを走らせてもエラーが出る
	- 何らかの原因でコンパイル、あるいは収束していません。必ずコンパイルを確認してください

<a id="anchor4"></a>
### フィードバック等に関して
- フィードバックなどが必要な場合は直接連絡をください

<a id="anchor5"></a>
### その他注意事項
- 絶対にMATLABでコンパイルするか確認してから送ってきてください
	- OctaveはMATLABの優秀な代替OSSですが、一部仕様が異なることがあります。
	- 例：ネイピア数がeと打てば出力されるため、直観的な“e^(x)”という表記が認められる
		- MATLABではネイピア数はexp(1)といった表記で初めて出力されます
		- よって、Octaveでコンパイルした「e^(x)」という部分がMATLABではエラーを吐きます
		- 他にもこのようなことがありますので、MATLABに移植してちゃんと動かしてください
	- コンパイルするかどうかはスクリプトファイルを実行してエラーが起きないかどうかで判別できます
		- 絶対に一度はMATLABでスクリプトファイルを実行させてください。
- 相談してもOKということになっているはずです
	- ただしコピペは厳禁
		- 最初の方は簡単なスクリプトが多いはずなので一言一句同じということも起こりうるとは思いますが、コピペでないかは一応チェックします
- 特にモンテカルロ法を行うときですが、マシンパワーには限界があるので異様な計算時間のものはコードのミスなどを確認してください
	- 1時間はおそらくこの課題の中ではそうそう起こりえないので、目安にしてください
- ツールボックスですが、私は学生版のライセンス\(無課金\)です
	- 学内ライセンスは概ね基本〜応用のツールボックスが使えるようです
	- もし特殊なツールボックスに入っている関数を使った場合は教えてください
- 疑問点があれば私の大学のアドレスにメールをしてもらえれば答えます

<a id="anchor6"></a>
### 便利なWebサービス
- [MathWorks Support](https://jp.mathworks.com/support.html)
	- 関数の説明などが調べられます
	- Google検索で「関数名+MATLAB」で検索してもMathWorksのサポートが上位に出ます
- [MATLAB Primer](http://www.math.toronto.edu/mpugh/primer.pdf)
	- 最低限必要な知識はここで得られます
	- 英語ですがそんなに難しくないので困ったら開くとよいです
- Google検索
	- 似たような処理を行っているブログがあります
	- 各々の検索能力に依存しますが、さっぱりわからない場合にはかなり有効です
- [カシオ: ブラックショールズ方程式 - 高精度計算サイト](https://keisan.casio.jp/exec/system/1161228904)
	- ヨーロピアンコールの理論値が計算できるので参考の値にできます
	- プットオップションの場合はプットコールパリティの関係で求められます
	- アメリカンコールもBSモデルにおいては理論価格がヨーロピアンコールと同じです

<a id="anchor7"></a>
### 参考: コーディングのあれこれ
- フォルダ分けをしっかり行う
	- 各課題ごとに適当な名前をつけたフォルダで作成\(例:No.1 Binomial Model for Call Option\)しておくと、あとで見つけやすいのでオススメです。
	- これをしておくと、流用した関数や使っている関数mファイルを送り損ねるといったことも減ります。
- 何事も名前はわかりやすく簡潔に書く
	- 入力だけでなく、途中で登場する計算結果も雑に名前をつけず、自分の納得のいく名前をつけると良いと思います
	- 序盤の関数は特にですが、あとあと流用することも多いので自作関数もわかりやすい名前にするのが良いです
- ループはわかりやすく組む
	- 入れ子式のループは特に文字が多く、どの文字が動いているのかがわからなくなりがちです
	- コメントアウトをつけるなど工夫をすると良いでしょう
- エラーが出ても諦めない
	- むしろ警告文をありがたく読んで根気強くデバッグしましょう
		- エラーが出ない方がデバッグは大変です
	- 経験則ですが、だいたい「行列の次元が合っていません」でエラーが出ています
	- 入力変数の値を変えてみるとわかることもあります
- コメントアウトをくどくない程度になるべく入れる
	- 文字化けには気をつけてもらえると助かります (特に留学生の皆さん)
		- 文字コードの制約を避けるために英語で書いてもらえると採点側も安心です
	- 「自分がどういった思いでそのコードを書いたのか」ということは往々にして忘れていきます。
	- わけがわからなくなって一旦時間をおいて課題を考え直すという場合に、コメントアウトがあると何がしたかったのかくらいは思い出せるのでなるべく書いておきましょう。
	- また、コンパイルはするが思い通りにいかないとき\(どうしても値が0になってしまう etc.\)に、どこからおかしくなっているのかの確認がスムーズになり、デバッグがしやすくなります。
- エラー原因がわからない場合の最終手段はコマンドウィンドウに直接入力する
	- 一行ずつコピペすると間違いがはっきりします。
	- これは本当に最終手段です。
- Octaveを使ってみる
	- MATLABを購入する人には関係ない話ですが、MATLABのオープンソースソフトのOctaveを使って家で試してから大学のMATLABで走らせることも可能です。
	- 序盤はだいたい可能ですが、特に終盤はOctaveにはない関数もあります
		- その頃には慣れてメモ帳にある程度書いてコピペしてちょちょっとデバッグするだけになっていたりもします。
		- 気にせずOSSに感謝して使いましょう。
- 値が不安な場合、BSモデル等を用いて理論値をチェックすることも有効です
